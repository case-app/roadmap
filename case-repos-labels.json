/**
 * Inspired by @Isaddo original script: https://gist.github.com/Isaddo/7efebcb673a0957b9c6f07cd14826ea4
 * Adds descriptions per @NillerMedDild https://gist.github.com/Isaddo/7efebcb673a0957b9c6f07cd14826ea4#gistcomment-2715349
 * 
 * Changes include:
 *  - CSS selectors use `js` prefix
 * 
 * Last tested 2019-July-27:
 *  - Chrome 75.0.3770.142
 *  - Safari 12.1.2
 *  - macOS 10.14.6
 */
 function createLabel( label ) {
    document.querySelector( '.js-new-label-name-input' ).value = label.name;
    document.querySelector( '.js-new-label-description-input' ).value = label.description;
    document.querySelector( '.js-new-label-color-input' ).value = '#' + label.color;
    document.querySelector( '.js-details-target ~ .btn-primary' ).disabled = false;
    document.querySelector( '.js-details-target ~ .btn-primary' ).click();
}

function updateLabel( label ) {
    let updatedLabel = false;
    [].slice.call( document.querySelectorAll( '.js-labels-list-item' ) ).forEach( element => {
        if ( element.querySelector( '.js-label-link' ).textContent.trim() === label.name ) {
            updatedLabel = true;
            element.querySelector( '.js-edit-label' ).click();
            element.querySelector( '.js-new-label-name-input' ).value = label.name;
            element.querySelector( '.js-new-label-description-input' ).value = label.description;
            element.querySelector( '.js-new-label-color-input' ).value = '#' + label.color;
            element.querySelector( '.js-edit-label-cancel ~ .btn-primary' ).click();
        }
    });
    return updatedLabel;
}

function createOrUpdate( label ) {
    if ( !updateLabel( label ) ) {
        createLabel( label );
    }
}

[
    {
        "name": "angular-library",
        "description": "Area: Angular library",
        "color": "F7AB14"
    },
    {
        "name": "ðŸ  Beta",
        "description": "Release phases:  Feature in Beta version. To validate before any deployment / Release",
        "color": "53CF9F"
    },
    {
        "name": "Blocked",
        "description": "Can't work on this task",
        "color": "EC8597"
    },
    {
        "name": "bug",
        "description": "Something isn't working",
        "color": "d73a4a"
    },
    {
        "name": "client",
        "description": "Area: CASE Client",
        "color": "F7AB14"
    },
    {
        "name": "create-edit",
        "description": "Case element: create-edit page",
        "color": "500C98"
    },
    {
        "name": "dependencies",
        "description": "Pull requests that update a dependency file",
        "color": "0366d6"
    },
    {
        "name": "Doc",
        "description": "Area: CASE Documentation",
        "color": "F7AB14"
    },
    {
        "name": "duplicate",
        "description": "This issue or pull request already exists",
        "color": "cfd3d7"
    },
    {
        "name": "enhancement",
        "description": "New feature or request",
        "color": "a2eeef"
    },
    {
        "name": "ðŸ’¬  Exploring",
        "description": "Release phases: this function is under discussion / proposal. it shouldn't be an issue",
        "color": "53CF9F"
    },
    {
        "name": "Field",
        "description": "Case element: Field",
        "color": "500C98"
    },
    {
        "name": "Filter",
        "description": "Case element: Filter",
        "color": "500C98"
    },
    {
        "name": "good first issue",
        "description": "Good for newcomers",
        "color": "7057ff"
    },
    {
        "name": "help wanted",
        "description": "Extra attention is needed",
        "color": "E8CEC4"
    },
    {
        "name": "inputs",
        "description": "Case element: Issues regarding inputs",
        "color": "500C98"
    },
    {
        "name": "invalid",
        "description": "This doesn't seem right",
        "color": "e4e669"
    },
    {
        "name": "List",
        "description": "Case element: list page",
        "color": "500C98"
    },
    {
        "name": "Nest library",
        "description": "Area: Nest library",
        "color": "F7AB14"
    },
    {
        "name": "Priority",
        "description": "Status: It's urgent to work on it",
        "color": "B60205"
    },
    {
        "name": "question",
        "description": "Further information is requested",
        "color": "E09392"
    },
    {
        "name": "âœ…  Ready",
        "description": "Release phases:  The feature is deployed and ready to use by the users.",
        "color": "53CF9F"
    },
    {
        "name": "refactor",
        "description": "Tasks to improve code without adding features",
        "color": "FEF2C0"
    },
    {
        "name": "regression",
        "description": null,
        "color": "D192BF"
    },
    {
        "name": "Schematics",
        "description": "Area: Schematics",
        "color": "F7AB14"
    },
    {
        "name": "Server",
        "description": "Area: CASE Server",
        "color": "F7AB14"
    },
    {
        "name": "Setup",
        "description": "Case element: Setup",
        "color": "500C98"
    },
    {
        "name": "Style",
        "description": null,
        "color": "500C98"
    },
    {
        "name": "ðŸŽ¨  To design",
        "description": "release phases: Provide UI",
        "color": "53CF9F"
    },
    {
        "name": "ðŸ“„  To document",
        "description": "Release phase: This feature is developed and needs documentation",
        "color": "53CF9F"
    },
    {
        "name": "ðŸ› ï¸. To implement",
        "description": "Release phases:  To develop",
        "color": "53CF9F"
    },
    {
        "name": "Website",
        "description": "Area: CASE website",
        "color": "F7AB14"
    },
    {
        "name": "wontfix",
        "description": "This will not be worked on",
        "color": "ffffff"
    },
    {
        "name": "Yield",
        "description": "Case element: Yield",
        "color": "500C98"
    }
].forEach( label => createOrUpdate( label ) );
